import{g as m,c as Q}from"./index-BhwCam4Z.js";function F(N,R){for(var l=0;l<R.length;l++){const o=R[l];if(typeof o!="string"&&!Array.isArray(o)){for(const S in o)if(S!=="default"&&!(S in N)){const c=Object.getOwnPropertyDescriptor(o,S);c&&Object.defineProperty(N,S,c.get?c:{enumerable:!0,get:()=>o[S]})}}}return Object.freeze(Object.defineProperty(N,Symbol.toStringTag,{value:"Module"}))}var B={exports:{}};(function(N,R){(function(l,o){N.exports=o()})(Q,()=>(()=>{var l,o,S={d:(r,e)=>{for(var s in e)S.o(e,s)&&!S.o(r,s)&&Object.defineProperty(r,s,{enumerable:!0,get:e[s]})},o:(r,e)=>Object.prototype.hasOwnProperty.call(r,e),r:r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},c={};S.r(c),S.d(c,{WatchWalletChanges:()=>K,addToken:()=>p,default:()=>b,getAddress:()=>g,getNetwork:()=>P,getNetworkDetails:()=>L,isAllowed:()=>G,isBrowser:()=>a,isConnected:()=>k,requestAccess:()=>H,setAllowed:()=>f,signAuthEntry:()=>h,signMessage:()=>y,signTransaction:()=>M}),function(r){r.CREATE_ACCOUNT="CREATE_ACCOUNT",r.FUND_ACCOUNT="FUND_ACCOUNT",r.ADD_ACCOUNT="ADD_ACCOUNT",r.IMPORT_ACCOUNT="IMPORT_ACCOUNT",r.IMPORT_HARDWARE_WALLET="IMPORT_HARDWARE_WALLET",r.LOAD_ACCOUNT="LOAD_ACCOUNT",r.MAKE_ACCOUNT_ACTIVE="MAKE_ACCOUNT_ACTIVE",r.UPDATE_ACCOUNT_NAME="UPDATE_ACCOUNT_NAME",r.GET_MNEMONIC_PHRASE="GET_MNEMONIC_PHRASE",r.CONFIRM_MNEMONIC_PHRASE="CONFIRM_MNEMONIC_PHRASE",r.CONFIRM_MIGRATED_MNEMONIC_PHRASE="CONFIRM_MIGRATED_MNEMONIC_PHRASE",r.RECOVER_ACCOUNT="RECOVER_ACCOUNT",r.CONFIRM_PASSWORD="CONFIRM_PASSWORD",r.REJECT_ACCESS="REJECT_ACCESS",r.GRANT_ACCESS="GRANT_ACCESS",r.ADD_TOKEN="ADD_TOKEN",r.SIGN_TRANSACTION="SIGN_TRANSACTION",r.SIGN_BLOB="SIGN_BLOB",r.SIGN_AUTH_ENTRY="SIGN_AUTH_ENTRY",r.HANDLE_SIGNED_HW_PAYLOAD="HANDLE_SIGNED_HW_PAYLOAD",r.REJECT_TRANSACTION="REJECT_TRANSACTION",r.SIGN_FREIGHTER_TRANSACTION="SIGN_FREIGHTER_TRANSACTION",r.SIGN_FREIGHTER_SOROBAN_TRANSACTION="SIGN_FREIGHTER_SOROBAN_TRANSACTION",r.ADD_RECENT_ADDRESS="ADD_RECENT_ADDRESS",r.LOAD_RECENT_ADDRESSES="LOAD_RECENT_ADDRESSES",r.LOAD_LAST_USED_ACCOUNT="LOAD_LAST_USED_ACCOUNT",r.SIGN_OUT="SIGN_OUT",r.SHOW_BACKUP_PHRASE="SHOW_BACKUP_PHRASE",r.SAVE_ALLOWLIST="SAVE_ALLOWLIST",r.SAVE_SETTINGS="SAVE_SETTINGS",r.SAVE_EXPERIMENTAL_FEATURES="SAVE_EXPERIMENTAL_FEATURES",r.LOAD_SETTINGS="LOAD_SETTINGS",r.LOAD_BACKEND_SETTINGS="LOAD_BACKEND_SETTINGS",r.GET_CACHED_ASSET_ICON_LIST="GET_CACHED_ASSET_ICON_LIST",r.GET_CACHED_ASSET_ICON="GET_CACHED_ASSET_ICON",r.CACHE_ASSET_ICON="CACHE_ASSET_ICON",r.GET_CACHED_ASSET_DOMAIN="GET_CACHED_ASSET_DOMAIN",r.CACHE_ASSET_DOMAIN="CACHE_ASSET_DOMAIN",r.GET_MEMO_REQUIRED_ACCOUNTS="GET_MEMO_REQUIRED_ACCOUNTS",r.ADD_CUSTOM_NETWORK="ADD_CUSTOM_NETWORK",r.CHANGE_NETWORK="CHANGE_NETWORK",r.REMOVE_CUSTOM_NETWORK="REMOVE_CUSTOM_NETWORK",r.EDIT_CUSTOM_NETWORK="EDIT_CUSTOM_NETWORK",r.RESET_EXP_DATA="RESET_EXP_DATA",r.ADD_TOKEN_ID="ADD_TOKEN_ID",r.GET_TOKEN_IDS="GET_TOKEN_IDS",r.REMOVE_TOKEN_ID="REMOVE_TOKEN_ID",r.GET_MIGRATABLE_ACCOUNTS="GET_MIGRATABLE_ACCOUNTS",r.GET_MIGRATED_MNEMONIC_PHRASE="GET_MIGRATED_MNEMONIC_PHRASE",r.MIGRATE_ACCOUNTS="MIGRATE_ACCOUNTS",r.ADD_ASSETS_LIST="ADD_ASSETS_LIST",r.MODIFY_ASSETS_LIST="MODIFY_ASSETS_LIST",r.CHANGE_ASSET_VISIBILITY="CHANGE_ASSET_VISIBILITY",r.GET_HIDDEN_ASSETS="GET_HIDDEN_ASSETS",r.GET_IS_ACCOUNT_MISMATCH="GET_IS_ACCOUNT_MISMATCH"}(l||(l={})),function(r){r.REQUEST_ACCESS="REQUEST_ACCESS",r.REQUEST_PUBLIC_KEY="REQUEST_PUBLIC_KEY",r.SUBMIT_TOKEN="SUBMIT_TOKEN",r.SUBMIT_TRANSACTION="SUBMIT_TRANSACTION",r.SUBMIT_BLOB="SUBMIT_BLOB",r.SUBMIT_AUTH_ENTRY="SUBMIT_AUTH_ENTRY",r.REQUEST_NETWORK="REQUEST_NETWORK",r.REQUEST_NETWORK_DETAILS="REQUEST_NETWORK_DETAILS",r.REQUEST_CONNECTION_STATUS="REQUEST_CONNECTION_STATUS",r.REQUEST_ALLOWED_STATUS="REQUEST_ALLOWED_STATUS",r.SET_ALLOWED_STATUS="SET_ALLOWED_STATUS",r.REQUEST_USER_INFO="REQUEST_USER_INFO"}(o||(o={}));const i=r=>{const e=Date.now()+Math.random();return window.postMessage({source:"FREIGHTER_EXTERNAL_MSG_REQUEST",messageId:e,...r},window.location.origin),new Promise(s=>{let n=0;r.type!==o.REQUEST_CONNECTION_STATUS&&r.type!==o.REQUEST_PUBLIC_KEY||(n=setTimeout(()=>{s({isConnected:!1,publicKey:""}),window.removeEventListener("message",t)},2e3));const t=A=>{var T,E;A.source===window&&((T=A==null?void 0:A.data)===null||T===void 0?void 0:T.source)==="FREIGHTER_EXTERNAL_MSG_RESPONSE"&&((E=A==null?void 0:A.data)===null||E===void 0?void 0:E.messagedId)===e&&(s(A.data),window.removeEventListener("message",t),clearTimeout(n))};window.addEventListener("message",t,!1)})},_={code:-1,message:"Node environment is not supported"},O={code:-1,message:"The wallet encountered an internal error. Please try again or contact the wallet if the problem persists."},u=async()=>{let r;try{r=await i({type:o.REQUEST_ACCESS})}catch(s){console.error(s)}const{publicKey:e}=r||{publicKey:""};return{publicKey:e,error:r==null?void 0:r.apiError}},U=async()=>{let r;try{r=await i({type:o.REQUEST_PUBLIC_KEY})}catch(e){console.error(e)}return{publicKey:(r==null?void 0:r.publicKey)||"",error:r==null?void 0:r.apiError}},D=async()=>{let r;try{r=await i({type:o.REQUEST_NETWORK_DETAILS})}catch(E){console.error(E)}const{networkDetails:e,apiError:s}=r||{networkDetails:{network:"",networkUrl:"",networkPassphrase:"",sorobanRpcUrl:void 0}},{network:n,networkUrl:t,networkPassphrase:A,sorobanRpcUrl:T}=e;return{network:n,networkUrl:t,networkPassphrase:A,sorobanRpcUrl:T,error:s}},w=async()=>{let r;try{r=await i({type:o.REQUEST_ALLOWED_STATUS})}catch(s){console.error(s)}const{isAllowed:e}=r||{isAllowed:!1};return{isAllowed:e,error:r==null?void 0:r.apiError}},g=async()=>{let r="";if(a){const e=await U();return r=e.publicKey,e.error?{address:r,error:e.error}:{address:r}}return{address:r,error:_}},p=async r=>{if(a){const e=await(async s=>{let n;try{n=await i({contractId:s.contractId,networkPassphrase:s.networkPassphrase,type:o.SUBMIT_TOKEN})}catch{return{error:O}}return{contractId:n.contractId,error:n==null?void 0:n.apiError}})(r);return e.error?{contractId:"",error:e.error}:{contractId:e.contractId||""}}return{contractId:"",error:_}},M=async(r,e)=>{if(a){const s=await(async(n,t)=>{const A=t==null?void 0:t.address,T=t==null?void 0:t.networkPassphrase;let E;try{E=await i({transactionXdr:n,network:void 0,networkPassphrase:T,accountToSign:A,type:o.SUBMIT_TRANSACTION})}catch{return{signedTransaction:"",signerAddress:"",error:O}}const{signedTransaction:d,signerAddress:C}=E;return{signedTransaction:d,signerAddress:C,error:E==null?void 0:E.apiError}})(r,e);return s.error?{signedTxXdr:"",signerAddress:"",error:s.error}:{signedTxXdr:s.signedTransaction,signerAddress:s.signerAddress}}return{signedTxXdr:"",signerAddress:"",error:_}},y=async(r,e)=>{if(a){const{isAllowed:s}=await w();if(!s){const t=await u();if(t.error)return{signedMessage:null,signerAddress:"",error:t.error}}const n=await(async(t,A,T)=>{let E;const d=(T||{}).address;try{E=await i({blob:t,accountToSign:d,apiVersion:"6.0.1",networkPassphrase:T==null?void 0:T.networkPassphrase,type:o.SUBMIT_BLOB})}catch{return{signedMessage:null,signerAddress:"",error:O}}const{signedBlob:C,signerAddress:I}=E;return{signedMessage:C||null,signerAddress:I,error:E==null?void 0:E.apiError}})(r,0,e);return n.error?{signedMessage:null,signerAddress:"",error:n.error}:{signedMessage:n.signedMessage,signerAddress:n.signerAddress}}return{signedMessage:null,signerAddress:"",error:_}},h=async(r,e)=>{if(a){const{isAllowed:s}=await w();if(!s){const t=await u();if(t.error)return{signedAuthEntry:null,signerAddress:"",error:t.error}}const n=await(async(t,A,T)=>{const E=(T||{}).address;let d;try{d=await i({entryXdr:t,accountToSign:E,apiVersion:"6.0.1",networkPassphrase:T==null?void 0:T.networkPassphrase,type:o.SUBMIT_AUTH_ENTRY})}catch(v){return console.error(v),{signedAuthEntry:null,signerAddress:"",error:O}}const{signedAuthEntry:C,signerAddress:I}=d;return{signedAuthEntry:C||null,signerAddress:I,error:d==null?void 0:d.apiError}})(r,0,e);return n.error?{signedAuthEntry:null,signerAddress:"",error:n.error}:{signedAuthEntry:n.signedAuthEntry,signerAddress:n.signerAddress}}return{signedAuthEntry:null,signerAddress:"",error:_}},k=async()=>a?window.freighter?Promise.resolve({isConnected:window.freighter}):(async()=>{let r={isConnected:!1};try{r=await i({type:o.REQUEST_CONNECTION_STATUS})}catch(e){console.error(e)}return{isConnected:r.isConnected}})():{isConnected:!1,error:_},P=async()=>{if(a){const r=await(async()=>{let e;try{e=await i({type:o.REQUEST_NETWORK_DETAILS})}catch(n){console.error(n)}const{networkDetails:s}=e||{networkDetails:{network:"",networkPassphrase:""}};return{network:s==null?void 0:s.network,networkPassphrase:s==null?void 0:s.networkPassphrase,error:e==null?void 0:e.apiError}})();return r.error?{network:"",networkPassphrase:"",error:r.error}:{network:r.network,networkPassphrase:r.networkPassphrase}}return{network:"",networkPassphrase:"",error:_}},L=async()=>{if(a){const r=await D();return r.error?{network:"",networkUrl:"",networkPassphrase:"",error:r.error}:{network:r.network,networkUrl:r.networkUrl,networkPassphrase:r.networkPassphrase,sorobanRpcUrl:r.sorobanRpcUrl}}return{network:"",networkUrl:"",networkPassphrase:"",error:_}},G=async()=>{let r=!1;if(a){const e=await w();return r=e.isAllowed,e.error?{isAllowed:r,error:e.error}:{isAllowed:r}}return{isAllowed:r,error:_}},f=async()=>{let r=!1;if(a){const e=await(async()=>{let s;try{s=await i({type:o.SET_ALLOWED_STATUS})}catch(t){console.error(t)}const{isAllowed:n}=s||{isAllowed:!1};return{isAllowed:n,error:s==null?void 0:s.apiError}})();return r=e.isAllowed,e.error?{isAllowed:r,error:e.error}:{isAllowed:r}}return{isAllowed:r,error:_}},H=async()=>{let r="";if(a){const e=await u();return r=e.publicKey,e.error?{address:r,error:e.error}:{address:r}}return{address:r,error:_}};class K{constructor(e=3e3){this.fetchInfo=async s=>{if(!this.isRunning)return;const n=await U(),t=await D();(n.error||t.error)&&s({address:"",network:"",networkPassphrase:"",error:n.error||t.error}),this.currentAddress===n.publicKey&&this.currentNetwork===t.network&&this.currentNetworkPassphrase===t.networkPassphrase||(this.currentAddress=n.publicKey,this.currentNetwork=t.network,this.currentNetworkPassphrase=t.networkPassphrase,s({address:n.publicKey,network:t.network,networkPassphrase:t.networkPassphrase})),setTimeout(()=>this.fetchInfo(s),this.timeout)},this.timeout=e,this.currentAddress="",this.currentNetwork="",this.currentNetworkPassphrase="",this.isRunning=!1}watch(e){return a?(this.isRunning=!0,this.fetchInfo(e),{}):{error:_}}stop(){this.isRunning=!1}}const a=typeof window<"u",b={getAddress:g,addToken:p,signTransaction:M,signMessage:y,signAuthEntry:h,isConnected:k,getNetwork:P,getNetworkDetails:L,isAllowed:G,setAllowed:f,requestAccess:H,WatchWalletChanges:K};return c})())})(B);var W=B.exports;const V=m(W),x=F({__proto__:null,default:V},[W]);export{x as i};
